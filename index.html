<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מחולל פרט לחזית ויטרינה</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>📐 מחולל פרט לחזית ויטרינה</h1>
    <p class="subtitle">הזן מידות וקבל שרטוט טכני באופן אוטומטי - מידות במ"מ.</p>

    <div class="wrap">
        <div class="card">
            <h2>הגדרת מידות 📐</h2>
            <div class="file-upload">
                <label for="excelFile" class="file-label">...</label>
                <input type="file" id="excelFile" accept=".xls,.xlsx">
                <span class="file-name">לא נבחר קובץ</span>
            </div>
            <div class="row">
                <div>
                    <label for="frontW">רוחב חזית</label>
                    <input id="frontW" type="number" value="400" min="100">
                </div>
                <div>
                    <label for="cabH">גובה חזית</label>
                    <input id="cabH" type="number" value="1920" min="500">
                </div>
            </div>
            <div class="row">
                <div>
                    <label for="rEdge">מיקום ציר תחתון ועליון</label>
                    <input id="rEdge" type="number" value="100" min="1">
                </div>
                <div>
                    <label for="rMidCount">כמות צירים דרושה</label>
                    <input id="rMidCount" type="number" value="4" min="1">
                </div>
            </div>
            <label for="sideSelect">כיוון פתיחת דלת ויטרינה</label>
            <select id="sideSelect">
                <option value="right" selected>ימין</option>
                <option value="left">שמאל</option>
            </select>
            <h2>פרטי יחידה 📝</h2>
            <div>
                <label for="Sapak">הזמנה עבור</label>
                <select id="Sapak">
                    <option value="bluran">בלורן</option>
                    <option value="nilsen">נילסן</option>
                </select>
            </div>
            <div class="row">
                <div>
                    <label for="planNum">מספר תוכנית</label>
                    <input id="planNum" type="text" placeholder="מספר תוכנית">
                </div>
                <div>
                    <label for="unitNum">מספר יחידה</label>
                    <input id="unitNum" type="text" placeholder="מספר יחידה">
                </div>
            </div>
            <div class="row">
                <div>
                    <label for="partName">שם מפרק</label>
                    <input id="partName" type="text" placeholder="פרץ ארי">
                </div>
                <div>
                    <label for="profileType">סוג פרופיל</label>
                    <select id="profileType">
                    </select>
                </div>
            </div>
            <div class="row">
                <div>
                    <label for="profileColor">גוון פרופיל</label>
                    <input id="profileColor" type="text" placeholder="לדוגמה: G05">
                </div>
                <div>
                    <label for="glassModel">דגם זכוכית</label>
                    <input id="glassModel" type="text" placeholder="לדוגמה: BL-103">
                </div>
            </div>
            <div class="row">
                <div>
                    <label for="glassTexture">כיוון טקסטורת זכוכית</label>
                    <select id="glassTexture">
                        <option value="none">ללא</option>
                        <option value="vertical">לגובה</option>
                        <option value="horizontal">לרוחב</option>
                    </select>
                </div>
                <div>
                    <label for="prepFor">כולל הכנה עבור</label>
                    <input id="prepFor" type="text" value="צירים">
                </div>
            </div>
            <div class="buttons-container">
                <button id="downloadBtn" type="button">הורד PDF 💾</button>
                <button id="batchSaveBtn" type="button">PDF BATCH 💾</button>
            </div>
            <!--<div id="readout" class="readout-container" style="display:none;">
                <h3>סיכום מידות 📏</h3>
                <div id="readout-content"></div>
            </div>-->
        </div>
        <div class="card drawing-card">
            <svg id="svg" viewBox="0 0 1000 1000" preserveAspectRatio="xMidYMin slice"></svg>
            <div class="svg-overlay">השרטוט יופיע כאן...</div>
        </div>
    </div>
    <div id="overlay" style="
         display:none;
         position:fixed;
         top:0;
         left:0;
         width:100%;
         height:100%;
         background:rgba(0,0,0,0.5);
         z-index:9999;
         justify-content:center;
         align-items:center;
         flex-direction:column;
         color:white;
         font-size:24px;
         font-weight:bold;">
        <div id="overlayText">שומר קבצים...</div>
        <div id="overlayAnimation" style="margin-top:20px;">⏳</div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/svg2pdf.js@2.5.0/dist/svg2pdf.umd.min.js"></script>
    <script src="Alef-normal.js"></script>
    <script src="profiles.js"></script>
    <script src="pdf.js"></script>
    <script src="main.js"></script>
</body>
</html>